/*
 * jQuery.zip2addr https://github.com/kotarok/jQuery.zip2addr Copyright 2010, Kotaro Kokubo a.k.a kotarok kotaro@nodot.jp / jQuery.Zip2AddrByClick.js v0.1 https://github.com/dounokouno/jQuery.Zip2AddrByClick Copyright 2012, TAGAWA Takao dounokouno@gmail.com / Dual licensed under the MIT or GPL Version 2 licenses. / Minified by YUI Compressor */
$.fn.zip2addrbyclick=function(e){var h=$.extend({api:"http://www.google.com/transliterate?langpair=ja-Hira|ja&jsonp=?",prefectureToken:"(東京都|道|府|県)",zipDelimiter:"-",zip:null,zip2:null,pref:null,addr:null},e);var b=$.fn.zip2addrbyclick.cache;var d=function(c,i){if(location.protocol==="https:"){h.api=h.api.replace(/http:/,"https:")}$.getJSON(h.api,{text:c},function(j){if(RegExp(h.prefectureToken).test(j[0][1][0])){i(j[0][1][0].replace(RegExp("(.*?"+h.prefectureToken+")(.+)"),function(l,k,n,m){return[k,m]}))}})};var f=(function(){if(h.pref){return function(i){var c=i.split(",");if(c){if(!RegExp(c[1]).test($(h.addr).val())){$(h.pref).val(c[0]);$(h.addr).val(c[1])}}else{if(!RegExp(c[1]).test($(h.addr).val())){$(h.pref).add(h.addr).val("")}}}}else{return function(j){var i=j.replace(",","");var c=h.addr;if(i){if(!RegExp(i).test($(c).val())){$(c).val(i)}}else{if(!RegExp(i).test($(c).val())){$(c).val("")}}}}})();var g=(function(){var i=/[\uFF01-\uFF5E]/g,c=function(j){return String.fromCharCode(j.charCodeAt()-65248)};return function(j){return j.replace(i,c)}})();var a=function(i){var c=g(i).replace(/\D/g,"");if(c.length===7){if(b[c]===undefined){d(c.replace(/(\d\d\d)(\d\d\d\d)/,"$1-$2"),function(j){b[c]=j;f(j)})}else{f(b[c])}}};this.each(function(){$(this).click(function(){if(h.zip&&h.zip2){a($(h.zip).val()+""+$(h.zip2).val())}else{if(h.zip){var c=$(h.zip);a(c.val());c.val(function(){return g(c.val()).replace(/\D/g,"").replace(/(\d\d\d)(\d\d\d\d)/,"$1"+h.zipDelimiter+"$2")})}}})});return this};$.fn.zip2addrbyclick.cache={};